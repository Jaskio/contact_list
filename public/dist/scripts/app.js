(function(){"use strict";function t(t,e){e.hashPrefix(""),t.when("/",{templateUrl:"dist/views/contacts.html",controller:"ContactsController",controllerAs:"CC"}).when("/contact/add",{templateUrl:"dist/views/add_contact.html",controller:"ContactsController",controllerAs:"CC"}).when("/contact/:id/edit",{templateUrl:"dist/views/edit_contact.html",controller:"ContactsController",controllerAs:"CC"})}function e(t,e){e.$on("$routeChangeStart",function(t,e,n){})}angular.module("phonebook",["ngRoute","angular.filter"]),angular.module("phonebook").config(t).run(e),t.$inject=["$routeProvider","$locationProvider"],e.$inject=["$location","$rootScope"]})(),function(){"use strict";function t(t,e,n,o){function r(t){C.mergeFormVisible=!0,C.merged_contact=t,C.phone_numbers=[],C.form_data=l(),C.merged_contact.forEach(function(t){C.preparedToDelete.push(t.id),t.phone.forEach(function(t){C.phone_numbers.push(t)})})}function a(){$("html, body").animate({scrollTop:$(".row").offset().top},700)}function i(t){n.path(t)}function c(){C.mergeListVisible=!0,a();for(var t=_.orderBy(C.contacts,["first_name","last_name"]),e=[],n=0;n<t.length-1;n++)t[n+1].first_name==t[n].first_name&&t[n+1].last_name==t[n].last_name&&(e.push(t[n]),e.push(t[n+1]),C.haveMergeList=!0);var o=_.uniq(e);C.merge_list=_.groupBy(o,"first_name")}function s(){var t="";Object.keys(C.merge_list).forEach(function(e,n){C.merge_list[e].map(function(n){n.id==C.preparedToDelete[0]&&(t=e)})}),C.form_data.first_name=C.merge_list[t][0].first_name,C.form_data.last_name=C.merge_list[t][0].last_name;var e=[];C.form_data.phone.forEach(function(t){e.push(JSON.parse(t))}),C.form_data.phone=e,delete C.merge_list[t],C.preparedToDelete.forEach(function(t){g(t)}),o(function(){h(),C.preparedToDelete=[],C.mergeFormVisible=!1},800)}function l(){return{first_name:"",last_name:"",address:"",postal_code:"",city:"",country:"",phone:[],email:""}}function u(){C.form_data.phone.push({number:C.phone_number}),C.phone_number=""}function f(){var t=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;if(""===C.form_data.first_name||""===C.form_data.last_name||""===C.form_data.address||""===C.form_data.postal_code||""===C.form_data.city||""===C.form_data.country||!t.test(C.form_data.email)||0===C.form_data.phone.length)return!0}function m(){if(""===C.form_data.address||""===C.form_data.postal_code||""===C.form_data.city||""===C.form_data.country||""===C.form_data.email||0===C.form_data.phone.length)return!0}function d(e){t.getContacts(e).then(function(t){e?C.form_data=t:C.contacts=t},function(t){console.log(t)})}function h(){t.addContact(C.form_data).then(function(t){console.log(t),C.successMessage=!0,o(function(){C.successMessage=!1,C.form_data=l()},1500),d(null)},function(t){console.log(t)})}function p(){t.updateContact(C.form_data).then(function(t){console.log(t),C.successMessage=!0,o(function(){C.successMessage=!1},1500),d(null)},function(t){console.log(t)})}function g(e){var n=e||C.form_data.id;t.deleteContact(n).then(function(t){console.log(t),d(null),C.confirmDelete=!1},function(t){console.log(t)})}var C=this,v=e.current.params.id;C.contacts=[],C.merge_list={},C.phone_number="",C.searchTerm="",C.currentPage=0,C.pageSize=3,C.mergeFormVisible=!1,C.mergeListVisible=!1,C.preparedToDelete=[],C.confirmDelete=!1,C.successMessage=!1,function(){d(v),C.form_data=l(),C.addContact=h,C.updateContact=p,C.deleteContact=g,C.showForm=r,C.mergeList=c,C.mergeProcess=s,C.addPhone=u,C.formValidation=f,C.mergeValidation=m,C.setURL=i}()}angular.module("phonebook").controller("ContactsController",t),t.$inject=["ContactsService","$route","$location","$timeout"]}(),function(){"use strict";function t(){return function(t,e){var n=[];return t.forEach(function(t){t.first_name.toLowerCase().startsWith(e.toLowerCase())||t.last_name.toLowerCase().startsWith(e.toLowerCase())||t.email.toLowerCase().startsWith(e.toLowerCase())?n.push(t):t.phone.forEach(function(o){o.number.toLowerCase().startsWith(e.toLowerCase())&&n.push(t)})}),n}}angular.module("phonebook").filter("search",t)}(),function(){"use strict";function t(){return function(t,e){return e=+e,t?t.slice(e):[]}}angular.module("phonebook").filter("startFrom",t)}(),function(){"use strict";function t(t,e){function n(n){var o=t.defer(),r=n||"";return e.get(c+r).then(function(t){o.resolve(t.data)},function(t){o.reject(t.data)}),o.promise}function o(n){var o=t.defer();return e.post(c,n).then(function(t){o.resolve(t.data)},function(t){o.reject(t.data)}),o.promise}function r(n){var o=t.defer();return e.put(c+n.id,n).then(function(t){o.resolve(t.data)},function(t){o.reject(t.data)}),o.promise}function a(n){var o=t.defer();return e.delete(c+n).then(function(t){o.resolve(t.data)},function(t){o.reject(t.data)}),o.promise}var i={},c="http://localhost:3000/contacts/";return function(){i.getContacts=n,i.addContact=o,i.updateContact=r,i.deleteContact=a}(),i}angular.module("phonebook").service("ContactsService",t),t.$inject=["$q","$http"]}(),function(){"use strict";function t(){return{restrict:"E",scope:{items:"=",pageSize:"=",currentPage:"="},templateUrl:"dist/views/pagination.html",controller:n,controllerAs:"PGC",bindToController:!0,link:e}}function e(t,e,n){}function n(t){function e(){n.maxPages=Math.ceil(n.items.length/n.pageSize),n.items.length/n.pageSize<1&&n.items.length/n.pageSize>0&&(n.maxPages=1),0==n.items.length&&(n.maxPages=0)}var n=this;t.$watch(function(){return n.items},function(t,n){t.length&&e()}),t.$watch(function(){return n.pageSize},e),n.setPage=function(t){n.currentPage=t},n.generatePages=function(t){for(var e=[],n=1;n<=t;n++)e.push(n);return e}}angular.module("phonebook").directive("pagination",t),n.$inject=["$scope"]}(),function(){"use strict";function t(){return{restrict:"E",scope:{back:"@back",forward:"@forward"},templateUrl:"dist/views/site_navigation.html",controller:n,controllerAs:"NC",bindToController:!0,link:e}}function e(t,e,n){angular.element(e[0].childNodes[0].childNodes[1]).on("click",function(){history.back(),t.$apply()}),angular.element(e[0].childNodes[0].childNodes[3]).on("click",function(){history.forward(),t.$apply()})}function n(t){}angular.module("phonebook").directive("siteNavigation",t),n.$inject=["$scope"]}();
//# sourceMappingURL=app.js.map
