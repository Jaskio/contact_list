(function(){"use strict";function t(t,e){e.hashPrefix(""),t.when("/",{templateUrl:"dist/views/contacts.html",controller:"ContactsController",controllerAs:"CC"}).when("/contact/add",{templateUrl:"dist/views/add_contact.html",controller:"ContactsController",controllerAs:"CC"}).when("/contact/:id/edit",{templateUrl:"dist/views/edit_contact.html",controller:"ContactsController",controllerAs:"CC"})}function e(t,e){e.$on("$routeChangeStart",function(t,e,n){})}angular.module("phonebook",["ngRoute","angular.filter"]),angular.module("phonebook").config(t).run(e),t.$inject=["$routeProvider","$locationProvider"],e.$inject=["$location","$rootScope"]})(),function(){"use strict";function t(t,e,n){function o(t){d.mergeFormVisible=!0,d.merged_contact=t,d.phone_numbers=[],d.merged_contact.forEach(function(t){d.preparedToDelete.push(t.id),t.phone.forEach(function(t){d.phone_numbers.push(t)})})}function r(){d.mergeListVisible=!0;for(var t=_.orderBy(d.contacts,["first_name","last_name"]),e=[],n=0;n<t.length-1;n++)t[n+1].first_name==t[n].first_name&&t[n+1].last_name==t[n].last_name&&(e.push(t[n]),e.push(t[n+1]));var o=_.uniq(e);d.merge_list=_.groupBy(o,"first_name")}function a(){var t="";Object.keys(d.merge_list).forEach(function(e,n){d.merge_list[e].map(function(n){n.id==d.preparedToDelete[0]&&(t=e)})}),delete d.merge_list[t],d.preparedToDelete.forEach(function(t){f(t)}),l(),d.preparedToDelete=[]}function c(){return{first_name:"",last_name:"",address:"",postal_code:"",city:"",country:"",phone:[],email:""}}function i(){d.form_data.phone.push({number:d.phone_number}),d.phone_number=""}function s(e){t.getContacts(e).then(function(t){e?d.form_data=t:d.contacts=t},function(t){console.log(t)})}function l(){t.addContact(d.form_data).then(function(t){console.log(t),s(null)},function(t){console.log(t)})}function u(){t.updateContact(d.form_data).then(function(t){console.log(t)},function(t){console.log(t)})}function f(e){var n=e||d.form_data.id;t.deleteContact(n).then(function(t){console.log(t),s(null),d.confirmDelete=!1},function(t){console.log(t)})}var d=this,m=e.current.params.id;d.contacts=[],d.merge_list={},d.phone_number="",d.searchTerm="",d.currentPage=0,d.pageSize=3,d.mergeFormVisible=!1,d.mergeListVisible=!1,d.preparedToDelete=[],d.confirmDelete=!1,function(){s(m),d.form_data=c(),d.addContact=l,d.updateContact=u,d.deleteContact=f,d.showForm=o,d.mergeList=r,d.mergeProcess=a,d.addPhone=i}()}angular.module("phonebook").controller("ContactsController",t),t.$inject=["ContactsService","$route","$location"]}(),function(){"use strict";function t(){return{restrict:"E",scope:{items:"=",pageSize:"=",currentPage:"="},templateUrl:"dist/views/pagination.html",controller:n,controllerAs:"PGC",bindToController:!0,link:e}}function e(t,e,n){}function n(t){function e(){n.maxPages=Math.ceil(n.items.length/n.pageSize),n.items.length/n.pageSize<1&&n.items.length/n.pageSize>0&&(n.maxPages=1),0==n.items.length&&(n.maxPages=0)}var n=this;t.$watch(function(){return n.items},function(t,n){t.length&&e()}),t.$watch(function(){return n.pageSize},e),n.setPage=function(t){n.currentPage=t},n.generatePages=function(t){for(var e=[],n=1;n<=t;n++)e.push(n);return e}}angular.module("phonebook").directive("pagination",t),n.$inject=["$scope"]}(),function(){"use strict";function t(){return{restrict:"E",scope:{back:"@back",forward:"@forward"},templateUrl:"dist/views/site_navigation.html",controller:n,controllerAs:"NC",bindToController:!0,link:e}}function e(t,e,n){angular.element(e[0].childNodes[0].childNodes[1]).on("click",function(){history.back(),t.$apply()}),angular.element(e[0].childNodes[0].childNodes[3]).on("click",function(){history.forward(),t.$apply()})}function n(t){}angular.module("phonebook").directive("siteNavigation",t),n.$inject=["$scope"]}(),function(){"use strict";function t(){return function(t,e){var n=[];return t.forEach(function(t){t.first_name.toLowerCase().startsWith(e.toLowerCase())||t.last_name.toLowerCase().startsWith(e.toLowerCase())||t.email.toLowerCase().startsWith(e.toLowerCase())?n.push(t):t.phone.forEach(function(o){o.number.toLowerCase().startsWith(e.toLowerCase())&&n.push(t)})}),n}}angular.module("phonebook").filter("search",t)}(),function(){"use strict";function t(){return function(t,e){return e=+e,t?t.slice(e):[]}}angular.module("phonebook").filter("startFrom",t)}(),function(){"use strict";function t(t,e){function n(n){var o=t.defer(),r=n||"";return e.get(i+r).then(function(t){o.resolve(t.data)},function(t){o.reject(t.data)}),o.promise}function o(n){var o=t.defer();return e.post(i,n).then(function(t){o.resolve(t.data)},function(t){o.reject(t.data)}),o.promise}function r(n){var o=t.defer();return e.put(i+n.id,n).then(function(t){o.resolve(t.data)},function(t){o.reject(t.data)}),o.promise}function a(n){var o=t.defer();return e.delete(i+n).then(function(t){o.resolve(t.data)},function(t){o.reject(t.data)}),o.promise}var c={},i="http://localhost:3000/contacts/";return function(){c.getContacts=n,c.addContact=o,c.updateContact=r,c.deleteContact=a}(),c}angular.module("phonebook").service("ContactsService",t),t.$inject=["$q","$http"]}();
//# sourceMappingURL=app.js.map
